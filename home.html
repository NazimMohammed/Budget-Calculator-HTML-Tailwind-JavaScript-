<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>(NZ)Budget-Calculator</title>
    <link rel="stylesheet" href="./style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <!-- fontawesomecdn -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
      integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <style>
      body {
        font-family: "Space Grotesk", sans-serif;
      }
      .bento-card {
        background: #ffffff;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid #e5e7eb;
      }
      .bento-card:hover {
        border-color: #6366f1;
        transform: scale(1.01);
      }
    </style>
    <script src="./script.js"></script>
  </head>
  <body
    class="min-h-screen flex flex-col items-center justify-center p-6 bg-zinc-950 text-white"
  >

  <!-- gridCOntainer -->
    <div
      class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full md:w-[85%] lg:w-[65%] m-5"
    >
      <div
        class="hidden md:flex justify-center items-center rounded-lg hover:scale-110 transition-all duration-300"
      >
      <!-- mylogo -->
        <img src="./NZ.png" alt="" class="h-[80px]" />
        <p class="text-zinc-400">Powered by NZ-Company</p>
      </div>

      <!-- balance -->
      <div
        class="md:col-span-2 border border-zinc-700 p-6 text-center bg-zinc-900/50 hover:scale-[102%] transition-all duration-300"
      >
        Total Balance
        <p id="balance" class="text-4xl font-bold text-lime-500">$1000</p>
      </div>

      <!-- Username -->
      <div
        class="md:col-start-4 border md:border-hidden border-zinc-700 flex flex-col justify-center items-center p-4 hover:scale-[102%] transition-all duration-300"
      >
        <h1 id="username" class="font-bold text-sm">Username</h1>
        <h5 id="uid" class="text-zinc-400 text-xs">UiD: #12345</h5>
        <!-- logout -->
        <button
          onclick="logout()"
          class="mt-3 px-4 py-1.5 text-[12px] font-semibold uppercase tracking-wider text-red-500 border border-red-500/30 rounded-md hover:bg-red-500 hover:text-black transition-all duration-300"
        >
          <i class="fa-solid fa-right-from-bracket mr-2"></i>Logout
        </button>
      </div>

      <!--  income  -->
      <div
        class="col-span-1 md:col-span-2 md:row-span-3 bg-zinc-900/50 border border-zinc-700 flex flex-col p-5 justify-between items-center hover:scale-[101%] hover:border-zinc-600 transition-all duration-300"
      >
        <div
          class="flex justify-between w-full text-lime-500 font-bold text-2xl px-2 my-4"
        >
          Add Income
          <div id="incomeArea" class="font-normal">$0</div>
        </div>
        <input
          id="incomeType"
          type="text"
          class="my-2 w-full h-[60px] rounded-lg bg-white/10 border border-white/20 px-5 text-white text-xl focus:outline-none focus:border-lime-500"
          placeholder="Income Type"
        />
        <input
          id="incomeAmount"
          type="number"
          class="my-2 w-full h-[60px] rounded-lg bg-white/10 border border-white/20 px-5 text-white text-xl focus:outline-none focus:border-lime-500"
          placeholder="Amount"
        />
        <button
          onclick="addIncome()"
          class="w-full bg-lime-500 text-black mt-4 h-[60px] rounded-lg font-bold hover:bg-lime-400 transition-colors"
        >
          Add Income
        </button>
      </div>

      <!-- expense  -->
      <div
        class="col-span-1 md:col-span-2 md:row-span-3 bg-zinc-900/50 border border-zinc-700 flex flex-col p-5 justify-between items-center hover:scale-[101%] hover:border-zinc-600 transition-all duration-300"
      >
        <div
          class="flex justify-between w-full text-2xl font-bold text-red-500 px-2 my-4"
        >
          Add Expense
          <div id="totalexp" class="font-normal">$0</div>
        </div>
        <input
          id="expenseType"
          type="text"
          class="my-2 w-full h-[60px] rounded-lg bg-white/10 border border-white/20 px-5 text-white text-xl focus:outline-none focus:border-red-500"
          placeholder="Expense Type"
        />
        <input
          id="expenseAmount"
          type="number"
          class="my-2 w-full h-[60px] rounded-lg bg-white/10 border border-white/20 px-5 text-white text-xl focus:outline-none focus:border-red-500"
          placeholder="Amount"
        />
        <button
          class="w-full bg-red-600 text-black mt-4 h-[60px] font-bold rounded-lg hover:bg-red-900 transition-colors"
          onclick="addExpense()"
        >
          Add Expense
        </button>
      </div>

      <!-- income log -->
      <div
        class="col-span-1 md:col-span-2 border px-5 pb-5 border-zinc-600 h-[220px] overflow-hidden hover:overflow-y-auto"
      >
        <h1
          class="text-2xl text-lime-500 mb-4 font-bold sticky top-0 bg-zinc-950 w-full mt-0 h-[70px] flex items-center"
        >
          My Incomes
        </h1>
        <table class="w-full text-left">
          <thead
            class="text-zinc-400 border-b border-white/10 sticky top-[50px] bg-zinc-950 transition-all duration-300 ease-in-out"
          >
            <tr>
              <th class="pb-2">Type</th>
              <th class="pb-2">Date</th>
              <th class="pb-2 text-right">Amount</th>
            </tr>
          </thead>
          <tbody id="incomeTable"></tbody>
        </table>
      </div>

      <!-- expenselog -->
      <div
        class="col-span-1 md:col-span-2 border px-5 pb-5 border-zinc-600 h-[220px] overflow-hidden hover:overflow-y-auto"
      >
        <h1
          class="text-2xl text-red-500 mb-4 font-bold sticky top-0 bg-zinc-950 w-full mt-0 h-[70px] flex items-center"
        >
          My Expense
        </h1>
        <table class="w-full text-left">
          <thead
            class="text-zinc-400 border-b border-white/10 sticky top-[50px] bg-zinc-950"
          >
            <tr>
              <th class="pb-2">Type</th>
              <th class="pb-2">Date</th>
              <th class="pb-2 text-right">Amount</th>
            </tr>
          </thead>
          <tbody id="expenseTable"></tbody>
        </table>
      </div>
    </div>
  </body>
  <script>
    
    const loggedUserID = localStorage.getItem("loggedUser");
    var userObj = JSON.parse(localStorage.getItem(loggedUserID));

    //display updated total income
    const totalIncome = Object.values(userObj.incomeSummary || {}).reduce(
      (sum, b) => sum + Number(b),
      0,
    );
    document.getElementById("incomeArea").innerHTML = `$${totalIncome}`;

    //display updated total expense
    const totalExpense = Object.values(userObj.expSummary || {}).reduce(
      (sum, e) => sum + Number(e),
      0,
    );
    document.getElementById("totalexp").innerHTML = `$${totalExpense}`;

    // display balance
    var balance = totalIncome - totalExpense;
    if (balance > 0) {
      document.getElementById("balance").innerHTML = `$${balance}`;
    } else {
      document.getElementById("balance").innerHTML = `$${balance}`;
    }

    username.innerHTML = `<span class="fw-bold text-lg">${userObj.uname}</span>`;
    uid.innerHTML = `UID:#${userObj.uid}`;

    renderIncomeTable();
    renderExpenseTable();
  </script>
</html>
